/*! For license information please see content.js.LICENSE.txt */
(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],s=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);s=!0);}catch(e){l=!0,o=e}finally{try{if(!s&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(l)throw o}}return c}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==n.return||n.return()}finally{if(s)throw i}}}}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){c(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function c(e,t,n){return(t=d(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(t){var n=function(t){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==e(n)?n:n+""}var f,p=function(){return u(function e(){s(this,e),this.keywordCache=new Map,this.contextCache=new Map,this.stats={hits:0,misses:0,apiCalls:0,cacheSize:0}},[{key:"getStats",value:function(){return i(i({},this.stats),{},{keywordCacheSize:this.keywordCache.size,contextCacheSize:this.contextCache.size,totalCacheSize:this.keywordCache.size+this.contextCache.size})}},{key:"clearAll",value:function(){this.keywordCache.clear(),this.contextCache.clear(),this.stats={hits:0,misses:0,apiCalls:0,cacheSize:0},console.log("All caches cleared")}},{key:"clearExpired",value:function(){var e,r=Date.now(),o=36e5,a=0,i=n(this.keywordCache.entries());try{for(i.s();!(e=i.n()).done;){var c=t(e.value,2),s=c[0];r-c[1].timestamp>o&&(this.keywordCache.delete(s),a++)}}catch(e){i.e(e)}finally{i.f()}var l,u=0,d=n(this.contextCache.entries());try{for(d.s();!(l=d.n()).done;){var f=t(l.value,2),p=f[0];r-f[1].timestamp>o&&(this.contextCache.delete(p),u++)}}catch(e){d.e(e)}finally{d.f()}console.log("Cleared ".concat(a," expired keyword entries and ").concat(u," expired context entries"))}},{key:"getHitRate",value:function(){var e=this.stats.hits+this.stats.misses;return e>0?(this.stats.hits/e*100).toFixed(2):0}},{key:"logPerformance",value:function(){var e=this.getStats();console.log("📊 Post Guardian Cache Performance:"),console.log("  Cache Hit Rate: ".concat(this.getHitRate(),"%")),console.log("  API Calls: ".concat(e.apiCalls)),console.log("  Cache Hits: ".concat(e.hits)),console.log("  Cache Misses: ".concat(e.misses)),console.log("  Keyword Cache Size: ".concat(e.keywordCacheSize)),console.log("  Context Cache Size: ".concat(e.contextCacheSize))}},{key:"exportCache",value:function(){return{keywordCache:Object.fromEntries(this.keywordCache),contextCache:Object.fromEntries(this.contextCache),stats:this.getStats()}}}])}(),y=function(){return u(function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;s(this,e),this.limit=t,this.cache=new Map,this.stats={hits:0,misses:0,apiCalls:0}},[{key:"get",value:function(e){if(this.cache.has(e)){var t=this.cache.get(e);return this.cache.delete(e),this.cache.set(e,t),this.stats.hits++,t}this.stats.misses++}},{key:"set",value:function(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.limit){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(e,t)}},{key:"has",value:function(e){return this.cache.has(e)}},{key:"clear",value:function(){this.cache.clear(),this.stats={hits:0,misses:0,apiCalls:0}}},{key:"size",value:function(){return this.cache.size}},{key:"getStats",value:function(){return i(i({},this.stats),{},{cacheSize:this.cache.size})}}])}();function h(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var s=r&&r.prototype instanceof c?r:c,l=Object.create(s.prototype);return m(l,"_invoke",function(n,r,o){var a,c,s,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return a=t,c=0,s=e,f.n=n,i}};function p(n,r){for(c=n,s=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],p=f.p,y=a[2];n>3?(o=y===r)&&(s=a[(c=a[4])?5:(c=3,3)],a[4]=a[5]=e):a[0]<=p&&((o=n<2&&p<a[1])?(c=0,f.v=r,f.n=a[1]):p<y&&(o=n<3||a[0]>r||r>y)&&(a[4]=n,a[5]=r,f.n=y,c=0))}if(o||n>1)return i;throw d=!0,r}return function(o,u,y){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,y),c=u,s=y;(t=c<2?e:s)||!d;){a||(c?c<3?(c>1&&(f.n=-1),p(c,s)):f.n=s:f.v=s);try{if(l=2,a){if(c||(o="next"),t=a[o]){if(!(t=t.call(a,s)))throw TypeError("iterator result is not an object");if(!t.done)return t;s=t.value,c<2&&(c=0)}else 1===c&&(t=a.return)&&t.call(a),c<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),c=1);a=e}else if((t=(d=f.n<0)?s:n.call(r,f))!==i)break}catch(t){a=e,c=1,s=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var i={};function c(){}function s(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(m(t={},r,function(){return this}),t),d=l.prototype=c.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,m(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return s.prototype=l,m(d,"constructor",l),m(l,"constructor",s),s.displayName="GeneratorFunction",m(l,o,"GeneratorFunction"),m(d),m(d,o,"Generator"),m(d,r,function(){return this}),m(d,"toString",function(){return"[object Generator]"}),(h=function(){return{w:a,m:f}})()}function m(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,t,n,r){if(t)o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n;else{var a=function(t,n){m(e,t,function(e){return this._invoke(t,n,e)})};a("next",0),a("throw",1),a("return",2)}},m(e,t,n,r)}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=x(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){c=!0,a=e},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw a}}}}function g(e,t,n,r,o,a,i){try{var c=e[a](i),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function b(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var a=e.apply(t,n);function i(e){g(a,r,o,i,c,"next",e)}function c(e){g(a,r,o,i,c,"throw",e)}i(void 0)})}}function w(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return E(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}"undefined"!=typeof window&&(window.PostGuardianCacheManager=p),console.log("Post Guardian content script loaded!"),f=window.PostGuardianConfig?window.PostGuardianConfig:{GEMINI_API_KEY:"AIzaSyAQQHZosNLZsF5QUzRc3NonigEecOGybFE",GEMINI_MODEL:"gemini-1.5-flash",DEBOUNCE_DELAY:1e3,CONFIDENCE_THRESHOLD:70,BANNER_COLORS:{LOW:"#28a745",MEDIUM:"#ffc107",HIGH:"#dc3545",UNKNOWN:"#6c757d"}};var k=new y(20),S=new y(20),C="";function A(e){return e.toLowerCase().replace(/\s+/g," ").trim()}function I(e,t){if(!t)return!0;var n=A(e),r=A(t),o=new Set(e.toLowerCase().split(/\s+/)),a=new Set(t.toLowerCase().split(/\s+/)),i=new Set([].concat(w(o),w(a)));return(Math.abs(o.size-a.size)+w(o).filter(function(e){return!a.has(e)}).length)/i.size>.3||n!==r}function O(e){var t=A(e),n=S.get(t);return n?Date.now()-n.timestamp>36e5?(S.delete(t),null):n.analysis:null}function L(e,t){var n=A(e);S.set(n,{analysis:t,timestamp:Date.now(),riskyElements:t.riskyElements||[]})}function T(e){return P.apply(this,arguments)}function P(){return(P=b(h().m(function e(t){var n,r,o;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if(f.GEMINI_API_KEY&&"YOUR_GEMINI_API_KEY"!==f.GEMINI_API_KEY){e.n=1;break}return console.warn("Gemini API key not configured. Please set your API key in config.js"),e.a(2,null);case 1:if(!(n=O(t))){e.n=2;break}return console.log("Using cached analysis"),e.a(2,n);case 2:return k.stats.apiCalls++,console.log("Making API call #".concat(k.stats.apiCalls," to Gemini via service worker")),e.p=3,e.n=4,chrome.runtime.sendMessage({type:"ANALYZE_TEXT",data:{text:t,config:f}});case 4:if(r=e.v,console.log(t),!r.success||!r.analysis){e.n=5;break}return L(t,r.analysis),chrome.runtime.sendMessage({type:"UPDATE_CACHE_STATS",stats:k.getStats()}),e.a(2,r.analysis);case 5:return console.error("Service worker analysis failed:",r.error),e.a(2,null);case 6:e.n=8;break;case 7:return e.p=7,o=e.v,console.error("Failed to communicate with service worker:",o),e.a(2,null);case 8:return e.a(2)}},e,null,[[3,7]])}))).apply(this,arguments)}function j(e,t,n){var r=e.innerText,o="",a={CRITICAL:"#ff0000ff",CREDENTIALS:"#dc3545",FINANCIAL:"#d63384",MEDICAL:"#e83e8c",LOCATION:"#fd7e14",PERSONAL_INFO:"#ffc107",FAMILY:"#17a2b8",DATES:"#6c757d",OTHER:"#6c757d",DEFAULT:"#bdbdbd"};if(n&&n.riskyElements&&n.riskyElements.length>0){var i=[];n.riskyElements.forEach(function(e){if(e.text)for(var t,n=a[e.type]||a.DEFAULT,o=new RegExp(e.text.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");null!==(t=o.exec(r));)i.push({start:t.index,end:t.index+t[0].length,text:t[0],color:n,type:e.type,risk:e.risk,alternatives:e.alternatives?e.alternatives.join("|"):""}),o.lastIndex===t.index&&o.lastIndex++}),i.sort(function(e,t){return e.start-t.start});for(var c=[],s=0,l=0;l<i.length;l++)i[l].start>=s&&(c.push(i[l]),s=i[l].end);for(var u=0,d=0;d<c.length;d++){var f=c[d];u<f.start&&(o+=z(r.slice(u,f.start))),o+='<span class="risky-word" style="border-bottom: 4px solid '.concat(f.color,'; padding-bottom: 2px; background: none; color: inherit; cursor: help; pointer-events: auto; display: inline; box-decoration-break: clone;" data-risk-type="').concat(f.type,'" data-risk-explanation="').concat(z(f.risk),'" data-alternatives="').concat(z(f.alternatives)).concat(z(f.risk),'">').concat(z(f.text),"</span>"),u=f.end}u<r.length&&(o+=z(r.slice(u)))}else o=z(r);t.innerHTML=o,t.querySelectorAll(".risky-word").forEach(function(e){e.removeEventListener("mouseenter",N),e.removeEventListener("mouseleave",M),e.addEventListener("mouseenter",N),e.addEventListener("mouseleave",M)})}function z(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function N(e){var t=e.target,n=t.getBoundingClientRect(),r=document.getElementById("post-guardian-tooltip");r&&r.remove();var o=t.dataset.riskType||"OTHER",a=t.dataset.riskExplanation||"This word may contain sensitive information.",i=t.dataset.alternatives?t.dataset.alternatives.split("|"):[],c="#6c757d";["CRITICAL"].includes(o)?c="#ff0000ff":["CREDENTIALS"].includes(o)?c="#dc3545":["FINANCIAL"].includes(o)?c="#d63384":["MEDICAL"].includes(o)?c="#e83e8c":["LOCATION"].includes(o)?c="#fd7e14":["PERSONAL_INFO"].includes(o)?c="#ffc107":["FAMILY"].includes(o)?c="#17a2b8":(["DATES"].includes(o)||["OTHER"].includes(o))&&(c="#6c757d");var s=o.toLowerCase().split("_").map(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}).join(" "),l=document.createElement("div");l.id="post-guardian-tooltip",l.style="\n        position: fixed;\n        top: ".concat(n.bottom+8,"px;\n        left: ").concat(Math.min(n.left,window.innerWidth-360),"px;\n        background: #fff;\n        color: #222;\n        padding: 20px 24px 18px 20px;\n        border-radius: 14px;\n        font-size: 15px;\n        z-index: 10000;\n        max-width: 340px;\n        min-width: 220px;\n        box-shadow: 0 8px 32px rgba(0,0,0,0.18);\n        border: 1.5px solid #ff0000ff;\n        font-family: 'Inter', 'Segoe UI', Arial, sans-serif;\n        display: flex;\n        flex-direction: column;\n        gap: 8px;\n        animation: fadeInBanner 0.3s;\n    ");var u='<span style="display:inline-block;width:13px;height:13px;border-radius:50%;background:'.concat(c,';margin-right:10px;vertical-align:middle;"></span>'),d=a.split(". ").slice(0,2).join(". ")+(a.endsWith(".")?"":"."),f="\n        ".concat('<span id="pg-tooltip-close" style="position:absolute;top:8px;right:12px;font-size:18px;cursor:pointer;color:#888;">&times;</span>','\n        <div style="display:flex;align-items:center;margin-bottom:6px;">\n            ').concat(u,'\n            <span style="font-weight:600;font-size:16px;color:').concat(c,'; text-transform: lowercase; text-transform: capitalize;">').concat(s,' Risk</span>\n        </div>\n        <div style="margin-bottom:6px;font-weight:600;">"').concat(t.textContent,'"</div>\n        <div style="margin-bottom:8px;font-size:14px;color:').concat(c,';"><strong>Why this is risky:</strong> ').concat(d,"</div>\n    ");i.length>0&&""!==i[0].trim()&&(f+='\n            <div style="font-size: 14px; color: #2563eb; margin-top: 2px; text-transform: capitalize">\n                <strong>How to rephrase:</strong><br>\n                '.concat(i.map(function(e){return"• ".concat(e)}).join("<br>").split(a),"\n            </div>\n        ")),l.innerHTML=f,document.body.appendChild(l),l.querySelector("#pg-tooltip-close").onclick=function(){return l.remove()};var p=l.getBoundingClientRect();p.right>window.innerWidth&&(l.style.left="".concat(window.innerWidth-p.width-10,"px")),p.bottom>window.innerHeight&&(l.style.top="".concat(n.top-p.height-8,"px"))}function M(){var e=document.getElementById("post-guardian-tooltip");e&&e.remove()}!function(){if(!document.getElementById("post-guardian-styles")){var e=document.createElement("style");e.id="post-guardian-styles",e.innerHTML="\n    .post-guardian-scorebar {\n        width: 100%;\n        max-width: 500px;\n        margin: 0 auto 8px auto;\n        height: 18px;\n        border-radius: 9px;\n        background: linear-gradient(90deg, #e0e7ef 0%, #f3f4f6 100%);\n        box-shadow: 0 2px 12px rgba(0,0,0,0.04);\n        overflow: hidden;\n        position: relative;\n        transition: background 0.3s;\n    }\n    .post-guardian-scorebar-inner {\n        height: 100%;\n        border-radius: 9px;\n        background: linear-gradient(90deg, #28a745 0%, #ffc107 50%, #dc3545 100%);\n        transition: width 0.5s cubic-bezier(.4,2,.6,1), background 0.3s;\n    }\n    .post-guardian-scorebar-label {\n        position: absolute;\n        left: 50%;\n        top: 50%;\n        transform: translate(-50%, -50%);\n        font-size: 12px;\n        font-weight: 500;\n        color: #222;\n        text-shadow: none;\n        pointer-events: none;\n        font-family: 'Inter', 'Segoe UI', Arial, sans-serif;\n    }\n    .post-guardian-banner-animated {\n        animation: fadeInBanner 0.7s;\n        box-shadow: 0 4px 24px rgba(0,0,0,0.06);\n        border-radius: 8px;\n        transition: background 0.3s, color 0.3s;\n    }\n    @keyframes fadeInBanner {\n        from { opacity: 0; transform: translateY(-10px); }\n        to { opacity: 1; transform: translateY(0); }\n    }\n    .risky-word {\n        animation: riskyPulse 1.5s infinite alternate;\n        transition: border-color 0.3s;\n    }\n    @keyframes riskyPulse {\n        0% { border-bottom-width: 2px; }\n        100% { border-bottom-width: 4px; }\n    }\n    /* Dark mode support */\n    @media (prefers-color-scheme: dark) {\n        .post-guardian-scorebar {\n            background: linear-gradient(90deg, #23272f 0%, #2d3748 100%);\n        }\n        .post-guardian-scorebar-label {\n            color: #eee;\n        }\n        .post-guardian-banner-animated {\n            background: #23272f !important;\n            color: #eee !important;\n        }\n        #post-guardian-tooltip {\n            background: #23272f !important;\n            color: #eee !important;\n            border: 1px solid #444 !important;\n        }\n    }\n    ",document.head.appendChild(e)}}();var R,_,D=(R=function(){return F.apply(this,arguments)},function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];clearTimeout(_),_=setTimeout(function(){clearTimeout(_),R.apply(void 0,t)},900)}),H=new MutationObserver(function(){null==G||G(),document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){e.style.position="relative",function(e,t){var n,r,o="post-guardian-overlay-".concat(t);if(null===(n=e.parentElement)||void 0===n||!n.querySelector("#".concat(o))){var a=document.createElement("div");a.id=o,a.style="\n        position: absolute;\n        top: ".concat(e.offsetTop,"px;\n        left: ").concat(e.offsetLeft,"px;\n        width: ").concat(e.offsetWidth,"px;\n        height: ").concat(e.offsetHeight,"px;\n        pointer-events: none;\n        color: transparent;\n        white-space: pre-wrap;\n        overflow-wrap: break-word;\n        z-index: 9999;\n        font-size: ").concat(window.getComputedStyle(e).fontSize,";\n        line-height: ").concat(window.getComputedStyle(e).lineHeight,";\n        font-family: ").concat(window.getComputedStyle(e).fontFamily,";\n        padding: ").concat(window.getComputedStyle(e).padding,";\n    "),a.className="post-guardian-overlay",null===(r=e.parentElement)||void 0===r||r.appendChild(a),j(e,a,null)}}(e,t)})});function q(e,t){if(!t||!t.riskyElements||0===t.riskyElements.length)return e.style.display="none",void(e.innerHTML="");var n=f.BANNER_COLORS[t.riskLevel]||f.BANNER_COLORS.UNKNOWN;e.classList.add("post-guardian-banner-animated"),e.style="\n        background: ".concat(n,"10;\n        padding: 14px 18px;\n        margin-top: 8px;\n        font-size: 14px;\n        color: ").concat(n,";\n        border-left: 4px solid ").concat(n,";\n        border-radius: 8px;\n        font-family: 'Inter', 'Segoe UI', Arial, sans-serif;\n        box-shadow: 0 2px 12px rgba(0,0,0,0.06);\n    ");var r="<strong>".concat(t.riskyElements.length," privacy risk").concat(t.riskyElements.length>1?"s":"",' detected.</strong> <span style="font-size:13px;color:#555;">Click underlined words for details.</span>');t.confidence>f.CONFIDENCE_THRESHOLD&&(r+='<div style="font-size:12px;color:#888;margin-top:8px;">Confidence: '.concat(t.confidence,"%</div>")),e.innerHTML=r,e.style.display=""}function G(){document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){var n,r;if(null===(n=e.parentElement)||void 0===n||!n.querySelector("#post-guardian-banner-".concat(t))){var o=document.createElement("div");o.id="post-guardian-banner-".concat(t),o.style="\n            background: rgba(0, 123, 255, 0.1);\n            padding: 8px;\n            margin-top: 5px;\n            font-size: 12px;\n            color: #007bff;\n            border-left: 3px solid #007bff;\n        ",o.innerText="🛡️ Post Guardian is watching this tweet for privacy risks...",null===(r=e.parentElement)||void 0===r||r.insertBefore(o,e.nextSibling)}})}function F(){return(F=b(h().m(function e(){var t,n,r,o,a,i;return h().w(function(e){for(;;)switch(e.n){case 0:if(t=document.querySelectorAll('span[data-text="true"]'),n="",t.forEach(function(e){var t=e.textContent;n+=t+" "}),0!==(r=n.trim()).length){e.n=1;break}return document.querySelectorAll('[id^="post-guardian-banner-"]').forEach(function(e){e.style.display="none"}),document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){var n,r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));r&&(r.innerHTML="")}),C="",e.a(2,null);case 1:if((o=document.querySelectorAll('[aria-label="Post text"]')).forEach(function(e,t){var n,o=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));o&&j(e,o,O(r))}),a=I(r,C),i=null,!a){e.n=3;break}return C=r,e.n=2,T(r);case 2:(i=e.v)&&i.riskyElements,document.querySelectorAll('[id^="post-guardian-banner-"]').forEach(function(e){i&&"LOW"!==i.riskLevel?(e.style.display="",q(e,i)):e.style.display="none"}),o.forEach(function(e,t){var n,r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));r&&j(e,r,i)}),e.n=4;break;case 3:(i=O(r))&&i.riskyElements,i&&document.querySelectorAll('[id^="post-guardian-banner-"]').forEach(function(e){i&&"LOW"!==i.riskLevel?(e.style.display="",q(e,i)):e.style.display="none"});case 4:return e.a(2,i)}},e)}))).apply(this,arguments)}document.addEventListener("input",function(e){e.target.closest('[contenteditable="true"]')&&(document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){var n,r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));r&&j(e,r,O(e.innerText))}),D())}),document.addEventListener("keydown",function(e){e.target.closest('[contenteditable="true"]')&&(["Backspace","Delete"].includes(e.key)&&setTimeout(function(){document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){var n,r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));r&&j(e,r,O(e.innerText))})},0),D())}),document.addEventListener("paste",function(e){e.target.closest('[contenteditable="true"]')&&setTimeout(function(){document.querySelectorAll('[aria-label="Post text"]').forEach(function(e,t){var n,r=null===(n=e.parentElement)||void 0===n?void 0:n.querySelector("#post-guardian-overlay-".concat(t));r&&j(e,r,O(e.innerText))}),D()},0)}),H.observe(document.body,{childList:!0,subtree:!0}),document.body.addEventListener("click",function(){var e=b(h().m(function e(t){return h().w(function(e){for(;;)switch(e.n){case 0:setTimeout(b(h().m(function e(){return h().w(function(e){for(;;)switch(e.n){case 0:document.querySelectorAll('input[type="file"]').forEach(function(e){e.dataset.pgIntercepted||(e.dataset.pgIntercepted="true",e.addEventListener("change",function(){var e=b(h().m(function e(t){var n,r,o,a,i,c,s,l;return h().w(function(e){for(;;)switch(e.p=e.n){case 0:if((n=t.target.files)&&0!==n.length){e.n=1;break}return e.a(2);case 1:r=v(n),e.p=2,r.s();case 3:if((o=r.n()).done){e.n=6;break}if(!(a=o.value).type.startsWith("video/")){e.n=5;break}return i=a,console.log("[Post Guardian] Intercepted video:",a.name),e.n=4,chrome.runtime.sendMessage({type:"ANALYZE_VIDEO",video:{vidFile:i}});case 4:c=e.v,console.log("Response from listener:",c),s=URL.createObjectURL(a),console.log("[Post Guardian] Blob URL: ".concat(s));case 5:e.n=3;break;case 6:e.n=8;break;case 7:e.p=7,l=e.v,r.e(l);case 8:return e.p=8,r.f(),e.f(8);case 9:return e.a(2)}},e,null,[[2,7,8,9]])}));return function(t){return e.apply(this,arguments)}}()))});case 1:return e.a(2)}},e)})),300);case 1:return e.a(2)}},e)}));return function(t){return e.apply(this,arguments)}}())})();